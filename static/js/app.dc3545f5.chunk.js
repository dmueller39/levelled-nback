(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{83:function(t,e,n){"use strict";n.d(e,"a",(function(){return jt}));var o=n(1),r=n.n(o),a=n(25),i=n.n(a),s=n(17),l=n.n(s),c=n(36),u=n.n(c),p=n(4),h=n.n(p),m=n(5),d=n.n(m),g=n(6),f=n.n(g),w=n(7),y=n.n(w),v=n(8),k=n.n(v),P=n(11),b=n(48),S=n.n(b);function B(t){for(var e,n,o=t.length;0!==o;)n=Math.floor(Math.random()*o),e=t[o-=1],t[o]=t[n],t[n]=e;return t}function E(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?E(Object(n),!0).forEach((function(e){S()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function C(t){for(var e=[],n=0;n<t.rows*t.columns;n++)e.push("white");return e}function D(t){return t%2==0?t/2:(t-1)/2}function x(t,e,n){var o=n-e-t.offDuration;return o<0?-1:2*Math.floor(o/(t.offDuration+t.onDuration))+(o%(t.offDuration+t.onDuration)>t.onDuration?1:0)}function M(t,e,n){for(var o=t*(.2+.1*Math.random()),r=[],a=0;a<t;a++)a<o?r.push(!0):r.push(!1);for(var i=B(r),s=[],l=0;l<t+n;l++){var c=Math.floor(Math.random()*e);l>=n&&(i[l-n]?c=s[l-n]:c==s[l-n]&&(c=Math.floor(Math.random()*e))),s.push(c)}return s}function T(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.nBack,o=t.turns,r=t.positionsEnabled,a=t.colorsEnabled,i=t.colorValues,s=t.turnsPerMinute,l=t.rows,c=t.columns;r||(l=1,c=1);var u=r?M(o,l*c,n):null,p=a?M(o,i.length,n):null,h=48e3/s,m=12e3/s;return{isPractice:e,nBack:n,rows:l,columns:c,gameTurns:o+n,positions:u,colors:p,colorValues:i,onDuration:h,offDuration:m}}function O(t){return{isRunning:!0,currentIndex:-1,positionButtonState:null==t.positions?0:1,colorButtonState:null==t.colors?0:1,squares:C(t),mistakes:0}}function j(t,e,n){var o=e.positionButtonState,r=e.mistakes,a=t.positions;if(null==a||2!=o)return e;var i=D(n);return i-t.nBack>=0&&(a[i]==a[i-t.nBack]?o=3:(o=4,r+=1)),_({},e,{positionButtonState:o,mistakes:r})}function L(t,e,n){var o=e.colorButtonState,r=e.mistakes,a=t.colors;if(null==a||2!=o)return e;var i=D(n);return i-t.nBack>=0&&(a[i]==a[i-t.nBack]?o=3:(o=4,r+=1)),_({},e,{colorButtonState:o,mistakes:r})}function W(t,e,n){var o=D(n);if(o<0)return e;var r=t.positions,a=t.colors,i=t.colorValues,s=C(t);if(n%2==0){var l=0;if(null!=r&&(l=r[o]),null!=a&&null!=i){var c=a[o];s[l]=i[c]}else s[l]="grey"}var u=e.positionButtonState,p=e.colorButtonState,h=e.isRunning,m=e.mistakes;if(n!=e.currentIndex){h=o<t.gameTurns;var d=o<t.nBack;if(!h||d)p=null==t.colors?0:1,u=null==t.positions?0:1;else if(n%2===0)p=null==t.colors?0:2,u=null==t.positions?0:2;else if(n%2===1){var g=D(n);g-t.nBack>=0&&(2==u&&null!=t.positions&&t.positions[g]==t.positions[g-t.nBack]&&(m+=1,u=4),2==p&&null!=t.colors&&t.colors[g]==t.colors[g-t.nBack]&&(m+=1,p=4))}}return{currentIndex:n,positionButtonState:u,colorButtonState:p,isRunning:h,squares:s,mistakes:m}}var I=n(13),F=n(34),G=n(2),A=n(3),H=n(18),V=function(t){function e(){var t,n;h()(this,e);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(n=f()(this,(t=y()(e)).call.apply(t,[this].concat(r))))._getColor=function(t){return n.props.gameState.squares[t]},n}return k()(e,t),d()(e,[{key:"render",value:function(){for(var t=[],e=this.props.gamePlan,n=e.columns,r=e.rows,a=Math.floor((this.props.width-2*this.props.margin-1*(n-1))/n),i=Math.floor((this.props.height-2*this.props.margin-1*(r-1))/r),s=0;s<n;s++)for(var l=0;l<r;l++){var c=s+"_"+l,u={left:s*(a+1)+this.props.margin,top:l*(i+1)+this.props.margin,height:i,width:a,backgroundColor:this._getColor(l*r+s)};t.push(o.createElement(G.a,{key:c,style:[N.square,u]}))}return o.createElement(G.a,{style:{width:this.props.width,height:this.props.height}},t)}}]),e}(o.Component),N=A.a.create({square:{backgroundColor:"white",position:"absolute"}});var K=function(){var t=!1;if("maxTouchPoints"in navigator)t=navigator.maxTouchPoints>0;else if("msMaxTouchPoints"in navigator)t=navigator.msMaxTouchPoints>0;else{var e=window.matchMedia&&matchMedia("(pointer:coarse)");if(e&&"(pointer:coarse)"===e.media)t=!!e.matches;else if("orientation"in window)t=!0;else{var n=navigator.userAgent;t=/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(n)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(n)}}return t}(),q=function(t){function e(){var t,n;h()(this,e);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(n=f()(this,(t=y()(e)).call.apply(t,[this].concat(r)))).componentDidMount=function(){return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:K||document.addEventListener("keydown",n._onKeyDown);case 1:case"end":return t.stop()}}))},n.componentWillUnmount=function(){return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:K||document.removeEventListener("keydown",n._onKeyDown);case 1:case"end":return t.stop()}}))},n._onKeyDown=function(t){t.key==n.props.inputKey&&n.props.onKeyPress()},n}return k()(e,t),d()(e,[{key:"render",value:function(){return K?null:o.createElement(G.a,null,this.props.children)}}]),e}(o.Component);P.a.get("window").width;function z(t){var e=t.buttonColor,n=t.disabled,r=t.callback,a=t.name,i=t.inputKey;return o.createElement(G.a,{style:J.inputContainer},o.createElement(H.a,{key:a,disabled:n,onPress:r},o.createElement(I.a,{style:[J.buttonText,{backgroundColor:e}]},a)),o.createElement(q,{inputKey:i,onKeyPress:r},o.createElement(I.a,{style:n?J.disabledInputKey:J.inputKey},"(",i,")")))}var R={gameState:{isRunning:!1,positionButtonState:0,colorButtonState:0,squares:["white","white","white","white","white","white","white","white","white"],currentIndex:-1,mistakes:0},startTime:0},U=function(t){function e(){var t,n;h()(this,e);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(n=f()(this,(t=y()(e)).call.apply(t,[this].concat(r)))).state=R,n._unsubscribe=function(){},n._clearTimer=function(){null!=n._timer&&clearInterval(n._timer),n._timer=null},n._endGame=function(t){return n.props.onCompleteGame(t),R},n._checkForVibration=function(t,e){(4==e.positionButtonState&&4!=t.positionButtonState||4==e.colorButtonState&&4!=t.colorButtonState)&&(console.log("vibrating"),F.a.vibrate())},n._onPressPosition=function(){var t=x(n.props.gamePlan,n.state.startTime,Date.now()),e=j(n.props.gamePlan,n.state.gameState,t);n._checkForVibration(n.state.gameState,e),n.setState({gameState:e})},n._onPressColor=function(){var t=x(n.props.gamePlan,n.state.startTime,Date.now()),e=L(n.props.gamePlan,n.state.gameState,t);n._checkForVibration(n.state.gameState,e),n.setState({gameState:e})},n._tick=function(){n.setState(n._updateState)},n._updateState=function(t){n.state.gameState.positionButtonState;if(t.gameState.isRunning){var e=x(n.props.gamePlan,n.state.startTime,Date.now()),o=W(n.props.gamePlan,n.state.gameState,e);return 0==o.isRunning?n._endGame({mistakes:o.mistakes,time:Date.now(),gamePlan:n.props.gamePlan}):(n._checkForVibration(n.state.gameState,o),{gameState:o})}return{}},n}return k()(e,t),d()(e,[{key:"componentDidMount",value:function(){var t=this;this._start(),this._unsubscribe=this.props.addBlurListener((function(){t._clearTimer()}))}},{key:"componentWillUnmount",value:function(){this._unsubscribe(),this._clearTimer()}},{key:"_start",value:function(){this._timer=setInterval(this._tick,40),this.setState({gameState:O(this.props.gamePlan),startTime:Date.now()})}},{key:"_renderButton",value:function(t,e,n,r){if(0!=n){var a="#8888FF",i=!1;switch(n){case 3:a="#88FF88";break;case 4:a="#FF8888";break;case 1:a="#CCCCFF",i=!0}return o.createElement(z,{key:e,name:t,buttonColor:a,disabled:i,callback:r,inputKey:e})}return null}},{key:"render",value:function(){var t=[],e=this._renderButton("position","a",this.state.gameState.positionButtonState,this._onPressPosition);null!=e&&t.push(e);var n=this._renderButton("color","l",this.state.gameState.colorButtonState,this._onPressColor);null!=n&&t.push(n);var r=Math.min(this.props.windowHeight-200,this.props.windowWidth);return o.createElement(G.a,{style:[J.container,{width:this.props.windowWidth,height:this.props.windowHeight}]},o.createElement(V,{width:r,height:r,margin:10,gamePlan:this.props.gamePlan,gameState:this.state.gameState}),o.createElement(G.a,{style:[J.buttonContainer,{width:this.props.windowWidth}]},t),this.props.isDebug?o.createElement(G.a,{pointerEvents:"none",style:J.debugText},o.createElement(I.a,{pointerEvents:"none",style:J.debugText},JSON.stringify(this.state.gameState,null,"\t"),JSON.stringify(this.props.gamePlan,null,"\t"))):null)}}]),e}(o.Component),J=A.a.create({buttonContainer:{flexDirection:"row",justifyContent:"space-evenly"},buttonText:{justifyContent:"center",color:"white",padding:10,fontSize:24},debugText:{position:"absolute",top:0,left:0,right:0,bottom:0,fontSize:10},container:{flex:1,alignItems:"center",padding:8},inputContainer:{alignItems:"center"},disabledInputKey:{color:"#888888"},inputKey:{color:"#111111"}});function Q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function X(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(n),!0).forEach((function(e){S()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Y(t,e,n,o,r){for(var a=[],i=[0,0,0],s=0,l=0;l<r.length;l++){var c=r[l],u=c.gamePlan,p=c.mistakes;if(!0!==u.isPractice&&null!=u.colors==e&&null!=u.positions==n)if(u.nBack==t&&u.gameTurns-t==o)i[s]=0==p?2:1,s++,a.push(r[l]);else if(u.nBack>=t&&u.gameTurns-u.nBack>=o&&0==p)for(var h=s;h<i.length;h++)0==i[h]&&(i[h]=3)}return{last3MasteryLevels:i,results:a}}function Z(t,e){for(var n=e.progressMap,o=n.offset,r=(n.spacing,n.minTurns),a=(n.maxTurns,n.minTurnsPerMinute),i=(n.maxTurnsPerMinute,n.steps),s=n.minNBack,l=(n.maxNBack,t.sort((function(t,e){return e.time-t.time}))),c=o+i,u=[],p=s;p<=8;p++)for(var h=0;h<=c;h++){var m=null,d=null,g=null;if(h<i){var f=p,w=h+r;m=X({nodeType:0==h?0:1,nBack:p,turns:h+r,turnsPerMinute:a},Y(f,!1,!0,w,l)),d=X({nodeType:0==h?0:1,nBack:p,turns:h+r,turnsPerMinute:a},Y(f,!0,!1,w,l)),g=X({nodeType:h==o?0:1,nBack:p,turns:h-o+r,turnsPerMinute:a},Y(p,!0,!0,h-o+r,l))}u.push({positions:m,colors:d,dual:g})}return u.map((function(t){return{key:(n=t,(null==n.positions?"null":n.positions.nBack+"-"+n.positions.turns)+"-"+(null==n.colors?"null":n.colors.nBack+"-"+n.colors.turns)+"="+(null==n.dual?"null":n.dual.nBack+"-"+n.dual.turns)),locations:[null==t.positions?null:X({},t.positions,{gameLevel:{nBack:t.positions.nBack,rows:e.rows,columns:e.columns,positionsEnabled:!0,colorsEnabled:!1,colorValues:["#000000"],turns:t.positions.turns,turnsPerMinute:t.positions.turnsPerMinute}}),null==t.colors?null:X({},t.colors,{gameLevel:{nBack:t.colors.nBack,rows:1,columns:1,positionsEnabled:!1,colorsEnabled:!0,colorValues:e.colorValues,turns:t.colors.turns,turnsPerMinute:t.colors.turnsPerMinute}}),null==t.dual?null:X({},t.dual,{gameLevel:{nBack:t.dual.nBack,rows:e.rows,columns:e.columns,positionsEnabled:!0,colorsEnabled:!0,colorValues:e.colorValues,turns:t.dual.turns,turnsPerMinute:t.dual.turnsPerMinute}})]};var n}))}var $=n(47);function tt(t,e){for(var n=[],o=t.rows*t.columns,r=0;r<o;r++)n.push("white");var a=0;if(null!=t.positions&&(a=t.positions[e]),null!=t.colors&&null!=t.colorValues){var i=t.colors[e];n[a]=t.colorValues[i]}else n[a]="grey";return n}function et(t,e,n){return null==t||e<n?"grey":t[e]==t[e-n]?"green":"red"}function nt(t,e,n,o){return null==t?"none":o==e||o==e-n?"flex":"none"}function ot(t,e,n){return n==t||t-e==n?1:t-e<n&&n<t?.85:.33}function rt(t,e,n){return n==t?"black":"transparent"}function at(t){for(var e=Math.min(Math.floor(t.height/(t.gamePlan.nBack+1)),62),n=[],r=t.currentStep,a=(et(t.gamePlan.colors,r,t.gamePlan.nBack),et(t.gamePlan.positions,r,t.gamePlan.nBack),0);a<t.gamePlan.gameTurns;a++){var i={squares:tt(t.gamePlan,a)},s=(nt(t.gamePlan.colors,r,t.gamePlan.nBack,a),nt(t.gamePlan.positions,r,t.gamePlan.nBack,a)),l=ot(r,t.gamePlan.nBack,a),c=rt(r,t.gamePlan.nBack,a),u={height:e};n.push(o.createElement(G.a,{key:"demo-grid-"+a,style:[it.gridContainer,u]},o.createElement(G.a,{style:[it.iconContainer,u]},o.createElement(I.a,{style:{fontSize:32,display:s}},"\ud83d\udc49")),o.createElement(G.a,{style:{height:e+2,opacity:l,borderWidth:2,borderColor:c}},o.createElement(V,{width:e,height:e,margin:4,gamePlan:t.gamePlan,gameState:i})),o.createElement(G.a,{style:[it.iconContainer,u]},o.createElement(I.a,{style:{fontSize:32,display:s}},"\ud83d\udc48"))))}t.gamePlan.positions,t.gamePlan.colors;return o.createElement($.a,{contentContainerStyle:it.container},n)}var it=A.a.create({header:{flexDirection:"row"},spacer:{width:60},text:{width:80,textAlign:"center"},iconContainer:{height:62,width:80,alignItems:"center",justifyContent:"center"},gridContainer:{height:62,flexDirection:"row"},container:{alignItems:"center",flex:1}}),st={gameState:{isRunning:!1,positionButtonState:0,colorButtonState:0,squares:["white","white","white","white","white","white","white","white","white"],currentIndex:-1,mistakes:0},startTime:0};function lt(t){return Math.floor(t/2)}function ct(t,e,n){if(null==t)return 0;var o=lt(e);return o<n?1:e%2?2:t[o]==t[o-n]?3:4}var ut=function(t){function e(){var t,n;h()(this,e);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(n=f()(this,(t=y()(e)).call.apply(t,[this].concat(r)))).state=st,n._endGame=function(){return null!=n._timer&&clearInterval(n._timer),n._timer=null,st},n._onPressPosition=function(){var t=x(n.props.gamePlan,n.state.startTime,Date.now()),e=j(n.props.gamePlan,n.state.gameState,t);n.setState({gameState:e})},n._onPressColor=function(){var t=x(n.props.gamePlan,n.state.startTime,Date.now()),e=L(n.props.gamePlan,n.state.gameState,t);n.setState({gameState:e})},n._tick=function(){n.setState(n._updateState)},n._updateState=function(t){n.state.gameState.positionButtonState;if(t.gameState.isRunning){var e=x(n.props.gamePlan,n.state.startTime,Date.now()),o=W(n.props.gamePlan,n.state.gameState,e);return 0==o.isRunning?n._endGame():{gameState:o}}return{}},n}return k()(e,t),d()(e,[{key:"componentDidMount",value:function(){this._start()}},{key:"componentWillUnmount",value:function(){this._endGame()}},{key:"_start",value:function(){this._timer=setInterval(this._tick,40),this.setState({gameState:O(this.props.gamePlan),startTime:Date.now()})}},{key:"_renderButton",value:function(t,e,n,r){if(0!=e){var a="#8888FF";switch(e){case 3:a="#88FF88";break;case 4:a="#FF8888";break;case 1:a="#CCCCFF"}return o.createElement(I.a,{key:t,style:[pt.buttonText,{backgroundColor:a,width:.3*r,fontSize:.07*r}]},t)}return null}},{key:"render",value:function(){var t=[],e=.5*this.props.width,n=lt(this.state.gameState.currentIndex),r=this._renderButton("position",ct(this.props.gamePlan.positions,this.state.gameState.currentIndex,this.props.gamePlan.nBack),this._onPressPosition,e);null!=r&&t.push(r);var a=this._renderButton("color",ct(this.props.gamePlan.colors,this.state.gameState.currentIndex,this.props.gamePlan.nBack),this._onPressColor,e);return null!=a&&t.push(a),o.createElement(G.a,{style:[pt.container,{width:this.props.width}]},o.createElement(G.a,{style:[pt.gameContainer,{width:e}]},o.createElement(at,{height:this.props.height-16,width:e,gamePlan:this.props.gamePlan,currentStep:n})),o.createElement(G.a,{style:[pt.gameContainer,{width:e}]},o.createElement(V,{width:e,height:e,margin:0,gamePlan:this.props.gamePlan,gameState:this.state.gameState}),o.createElement(G.a,{style:pt.buttonContainer},t)))}}]),e}(o.Component),pt=A.a.create({gameContainer:{},buttonContainer:{flexDirection:"row",justifyContent:"space-evenly"},buttonText:{justifyContent:"center",color:"white",padding:3,textAlign:"center"},container:{flex:1,flexDirection:"row",justifyContent:"center",padding:8}}),ht=n(42);function mt(t){switch(t){case 2:return"green";case 1:return"yellow";case 3:return"#DDDDDD"}return"white"}var dt=function(t){function e(){var t,n;h()(this,e);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(n=f()(this,(t=y()(e)).call.apply(t,[this].concat(r))))._onPress=function(){n.props.onPress()},n}return k()(e,t),d()(e,[{key:"render",value:function(){var t=mt(this.props.last3MasteryLevels[0]),e=mt(this.props.last3MasteryLevels[1]),n=mt(this.props.last3MasteryLevels[2]);return o.createElement(H.a,{style:[gt.container,this.props.style],onPress:this._onPress},o.createElement(ht.b,{height:"44",width:"44"},o.createElement(ht.a,{cx:"22",cy:"22",r:"14",fill:t,stroke:"black",strokeWidth:1}),o.createElement(ht.a,{cx:"22",cy:"22",r:"9",fill:e}),o.createElement(ht.a,{cx:"22",cy:"22",r:"4",fill:n})))}}]),e}(o.Component),gt=A.a.create({container:{height:44,width:44}}),ft=function(t){function e(t){var n;h()(this,e),(n=f()(this,y()(e).call(this,t)))._onStart=function(){var t=T(n.props.location.gameLevel);n.props.onStart(t)},n._onDemo=function(){n.setState({isDemo:!0})},n._onCancel=function(){n.state.isDemo?n.setState({isDemo:!1}):n.props.onCancel()};var o=T(n.props.location.gameLevel);return n.state={demoGamePlan:o,isDemo:!1},n}return k()(e,t),d()(e,[{key:"render",value:function(){return this.state.isDemo?o.createElement(G.a,{style:[{width:this.props.windowWidth,height:this.props.windowHeight},wt.container]},o.createElement(G.a,{style:wt.hContainer},o.createElement(I.a,{style:wt.cancelButton,onPress:this._onCancel},"Cancel"),o.createElement(I.a,{style:wt.playButton,onPress:this._onStart},"Start")),o.createElement(ut,{height:this.props.windowHeight-64,width:Math.min(this.props.windowWidth,600),gamePlan:this.state.demoGamePlan})):o.createElement(G.a,{style:[{width:this.props.windowWidth,height:this.props.windowHeight},wt.container]},o.createElement(G.a,{style:wt.hContainer},o.createElement(I.a,{style:wt.cancelButton,onPress:this._onCancel},"Cancel"),o.createElement(I.a,{style:wt.playButton,onPress:this._onStart},"Start")),o.createElement(G.a,{style:{flex:1,justifyContent:"center"}},o.createElement(I.a,{style:wt.headerText},null!=this.state.demoGamePlan.positions&&null!=this.state.demoGamePlan.colors?"Dual":""," ",this.state.demoGamePlan.nBack,"-Back","\n",this.state.demoGamePlan.gameTurns-this.state.demoGamePlan.nBack," ","Turns"),o.createElement(I.a,{style:wt.playButton,onPress:this._onDemo},"Demo")))}}]),e}(o.Component),wt=A.a.create({headerText:{textAlign:"center",fontSize:14,color:"black",fontWeight:"bold"},playButton:{color:"green",fontSize:24,textAlign:"center",padding:10},cancelButton:{color:"red",fontSize:24,textAlign:"center",padding:10},practiceButton:{color:"orange",fontSize:24,padding:2,marginRight:5},practiceInfoButton:{padding:6},container:{flex:1,alignItems:"center",justifyContent:"center",padding:8},header:{flexDirection:"row",padding:10},hContainer:{justifyContent:"center",flexDirection:"row"},hspacer:{flex:1},cancel:{width:44,height:44},nbacktext:{textAlign:"left",fontSize:15}}),yt=function(t){function e(){var t,n;h()(this,e);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(n=f()(this,(t=y()(e)).call.apply(t,[this].concat(r)))).state={isPlaying:!1,windowHeight:P.a.get("window").height,windowWidth:P.a.get("window").width},n._onDimensionsChange=function(){n.setState((function(){return{windowHeight:P.a.get("window").height,windowWidth:P.a.get("window").width}}))},n.componentDidMount=function(){return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:P.a.addEventListener("change",n._onDimensionsChange);case 1:case"end":return t.stop()}}))},n.componentWillUnmount=function(){return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:P.a.removeEventListener("change",n._onDimensionsChange);case 1:case"end":return t.stop()}}))},n._onStart=function(t){n.setState({isPlaying:!0,gamePlan:t})},n._onCompleteGame=function(t){n.props.onCompleteGame(t)},n}return k()(e,t),d()(e,[{key:"render",value:function(){return this.state.isPlaying&&null!=this.state.gamePlan?o.createElement(U,{gamePlan:this.state.gamePlan,isDebug:this.props.isDebug,windowWidth:this.state.windowWidth,windowHeight:this.state.windowHeight,onCompleteGame:this._onCompleteGame,addBlurListener:this.props.addBlurListener}):o.createElement(ft,{location:this.props.location,isDebug:this.props.isDebug,windowWidth:this.state.windowWidth,windowHeight:this.state.windowHeight,onStart:this._onStart,onCancel:this.props.onCancel})}}]),e}(o.Component),vt=[0,5,6,1,4,3,2,8,7];function kt(t){return{colors:B(t.colorValues),positions:B(vt)}}var Pt=function(t){function e(t){var n;return h()(this,e),(n=f()(this,y()(e).call(this,t))).state=kt(t.settings),n}return k()(e,t),d()(e,[{key:"componentDidUpdate",value:function(t){t.nBack!=this.props.nBack&&this.setState(kt(this.props.settings))}},{key:"getSquaresForStep",value:function(t,e){for(var n=this.props.colorsEnabled||!1,o=this.props.positionsEnabled||!1?e?this.state.positions[0]:this.state.positions[t]:0,r=n?e?this.state.colors[0]:this.state.colors[t]:"grey",a=[],i=0;i<9;i++)a.push("white");return a[o]=r,a}},{key:"render",value:function(){var t=this.props.positionsEnabled?{rows:3,columns:3}:{rows:1,columns:1},e=this.getSquaresForStep(0,!1);return o.createElement(G.a,{style:bt.container},o.createElement(V,{margin:1,width:26,height:26,gameState:{squares:e},gamePlan:t}))}}]),e}(o.Component),bt=A.a.create({square:{backgroundColor:"white",position:"absolute"},container:{flex:1,flexDirection:"row",justifyContent:"center"}}),St=function(t){function e(){var t,n;h()(this,e);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(n=f()(this,(t=y()(e)).call.apply(t,[this].concat(r)))).state={},n}return k()(e,t),d()(e,[{key:"render",value:function(){var t=this,e=54*this.props.progressMap.length,n=Math.min(this.props.windowWidth,600),r=[];return this.props.progressMap.forEach((function(e,a){e.locations.forEach((function(e,i){if(null!=e){var s=e,l=54*a,c=(i+.5)*(n/3)-22;r.push(o.createElement(dt,{key:"LocationButton-"+a+"-"+i,style:{position:"absolute",left:c,top:l},last3MasteryLevels:e.last3MasteryLevels,onPress:function(){return t.props.onPressLocation(s)}}))}}))})),o.createElement(G.a,{style:{alignItems:"center"}},o.createElement(G.a,{style:{width:n,height:e}},r))}}]),e}(o.Component);function Bt(t){return["#3b2bc4","#3fc42b","#bcc42b","#c4892b","#c42b2b","#c42bbc","#8e8a91"][(t-1)%7]}var Et=function(t){function e(){var t,n;h()(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=f()(this,(t=y()(e)).call.apply(t,[this].concat(a)))).scrollView=null,n._onPressLocation=function(t){n.props.onPressLocation(t)},n._onPressLeft=function(){n.props.onUpdateNBack(Math.max(n.props.nBack-1,1))},n._onPressRight=function(){n.props.onUpdateNBack(Math.min(n.props.nBack+1,7))},n._renderArrowButton=function(t,e,n){var r=e?"grey":"black";return o.createElement(H.a,{disabled:e,style:_t.iconButton,onPress:n},o.createElement(I.a,{style:{fontSize:32,color:r}},t))},n}return k()(e,t),d()(e,[{key:"_renderHeader",value:function(){Bt(this.props.nBack);var t=Math.min(this.props.windowWidth,600);return o.createElement(G.a,{style:{width:this.props.windowWidth,flex:1,alignItems:"center"}},o.createElement(G.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center",width:t}},this._renderArrowButton("\u21e6",1==this.props.nBack,this._onPressLeft),o.createElement(I.a,{style:{textAlign:"center",flex:1,fontSize:14,color:"black",fontWeight:"bold",flexDirection:"row"}},"n-back = ",this.props.nBack),this._renderArrowButton("\u21e8",7==this.props.nBack,this._onPressRight)))}},{key:"_renderGuide",value:function(){Bt(this.props.nBack);var t=Math.min(this.props.windowWidth,600);return o.createElement(G.a,{style:{width:this.props.windowWidth,flex:1,alignItems:"center"}},o.createElement(G.a,{style:{flexDirection:"row",width:t,paddingTop:12,paddingBottom:16}},o.createElement(Pt,{settings:this.props.settings,nBack:this.props.nBack,positionsEnabled:!0}),o.createElement(Pt,{settings:this.props.settings,nBack:this.props.nBack,colorsEnabled:!0}),o.createElement(Pt,{settings:this.props.settings,nBack:this.props.nBack,positionsEnabled:!0,colorsEnabled:!0})))}},{key:"render",value:function(){var t=this,e=Z(this.props.results,this.props.settings).filter((function(e){return e.locations.filter((function(e){return null!=e&&e.gameLevel.nBack==t.props.nBack})).length>0})),n=Bt(this.props.nBack);return o.createElement(G.a,null,this._renderHeader(),this._renderGuide(),o.createElement(St,{backgroundColor:n,progressMap:e,onPressLocation:this._onPressLocation,windowHeight:this.props.windowHeight,windowWidth:this.props.windowWidth}))}}]),e}(o.Component),_t=A.a.create({iconButton:{flex:1,flexDirection:"row",justifyContent:"center"}}),Ct=function(t){function e(){var t,n;h()(this,e);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(n=f()(this,(t=y()(e)).call.apply(t,[this].concat(r)))).state={currentLocation:null,windowHeight:P.a.get("window").height,windowWidth:P.a.get("window").width},n._onDimensionsChange=function(){n.setState((function(){return{windowHeight:P.a.get("window").height,windowWidth:P.a.get("window").width}}))},n.componentDidMount=function(){return l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:P.a.addEventListener("change",n._onDimensionsChange);case 1:case"end":return t.stop()}}))},n._onPressLocation=function(t){n.props.setLocation(t)},n}return k()(e,t),d()(e,[{key:"render",value:function(){var t=this.props,e=t.results,n=t.settings;if(null==e||null==n)return null;Z(e,n);return o.createElement(G.a,{style:[{width:this.state.windowWidth},Dt.container]},o.createElement(Et,{nBack:this.props.position,results:e,settings:n,onPressLocation:this._onPressLocation,onUpdateNBack:this.props.storePosition,windowHeight:this.state.windowHeight,windowWidth:this.state.windowWidth}))}}]),e}(o.Component),Dt=A.a.create({container:{},hContainer:{padding:8,margin:"auto"}});function xt(t){var e=Object(o.useState)(null),n=u()(e,2),a=n[0],i=n[1];if(null==a)return r.a.createElement(Ct,{results:t.results,storePosition:t.storePosition,settings:t.settings,position:t.position,setLocation:i});return r.a.createElement(yt,{isDebug:t.isDebug,location:a,onCompleteGame:function(e){i(null),t.onCompleteGame(e)},addBlurListener:function(t){return window.addEventListener("blur",t),function(){window.removeEventListener("blur",t)}},onCancel:function(){i(null)}})}var Mt={nBack:2,rows:3,columns:3,turns:20,positionsEnabled:!0,colorsEnabled:!0,colorValues:["red","blue","green","yellow","orange","purple"],onDuration:4e3,offDuration:1e3,progressMap:{offset:0,spacing:3,minTurns:4,maxTurns:20,minTurnsPerMinute:10,maxTurnsPerMinute:10,steps:9,minNBack:1,maxNBack:10},weeklyGoal:7},Tt=n(54);function Ot(){var t=Object(o.useState)(1),e=u()(t,2),n=e[0],a=e[1],s=Object(o.useState)([]),c=u()(s,2),p=c[0],h=c[1];return Object(o.useEffect)((function(){!function(){var t=document.body;null!=t&&(t.style="background: #EEEEEE;")}(),function(){var t;l.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.awrap(Tt.a.getItem("mapNBack"));case 2:t=e.sent,a(parseInt(t)||1);case 4:case"end":return e.stop()}}))}(),window.onmessage=function(t){if("string"===typeof t.data&&t.data.startsWith(window.location.href+";data;")){var e=t.data.split(";").slice(2).map((function(t){return JSON.parse(t)}));h(e)}},window.top.postMessage(window.location.href+";ready","*")}),[]),r.a.createElement(xt,{isDebug:!1,settings:Mt,onCompleteGame:function(t){if(null!=t){var e=[].concat(i()(p),[t]);h(e),l.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:Tt.a.setItem("results",JSON.stringify(e));case 1:case"end":return t.stop()}}));var n=window.location.href+";complete;"+JSON.stringify(t);window.top.postMessage(n,"*")}},storePosition:function(t){a(t),Tt.a.setItem("mapNBack",(t||1).toString())},position:n,results:p})}function jt(t){return o.createElement(Ot,t)}},84:function(t,e,n){n(85),t.exports=n(118)},85:function(t,e){"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/levelled-nback/expo-service-worker.js",{scope:"/levelled-nback/"}).then((function(t){})).catch((function(t){console.info("Failed to register service-worker",t)}))}))}},[[84,1,2]]]);
//# sourceMappingURL=app.dc3545f5.chunk.js.map